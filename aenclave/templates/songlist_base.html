{% extends "header_base.html" %}
{% load aenclave %}

{% block styles %}{{block.super}}
 <link rel="stylesheet" type="text/css" href="/media/aenclave/styles/songlist.css">{% endblock %}

{% block scripts %}{{block.super}}
 <script type="text/javascript" src="/media/aenclave/scripts/songlist.js"></script>{% endblock %}

{% block content %}{% block presonglist %}{% endblock %}{% if song_list or current_song %}
 <table class=data id=songlist>
  <thead><tr>
   <th style="width:1px;"><input type=checkbox onclick="songlist.select_all(this);"></th>{% if current_song %}
   <th style="width:40px;">Track</th>
   <th>Title</th>
   <th>Album</th>
   <th>Artist</th>
   <th style="width:40px;">Time</th>
   <th style="width:130px;">Date added</th>{% else %}
   <th class=sort sorttype=int onclick="songlist.sorta(this);" style="width:40px;">Track</th>
   <th class=sort sorttype=text onclick="songlist.sorta(this);">Title</th>
   <th class=sort sorttype=text onclick="songlist.sorta(this);">Album</th>
   <th class=sort sorttype=text onclick="songlist.sorta(this);">Artist</th>
   <th class=sort sorttype=time onclick="songlist.sorta(this);" style="width:40px;">Time</th>
   <th class=sort sorttype=date onclick="songlist.sorta(this);" style="width:130px;">Date added</th>{% endif %}{% if user.is_authenticated %}
   <th class=edit></th>{% endif %}
  </tr></thead>
  <tbody>{% if skipping %}
   <tr class=c>
    <td class=c><img src="/media/aenclave/images/speaker.png"></td>
    <td class=c colspan=7>(Dequeuing current song...)</td>
   </tr>{% else %}{% if current_song %}
   <tr class=c>
    <td class=c><img src="/media/aenclave/images/speaker.png" id=currentsong name="{{current_song.id}}"/></td>
    <td name=track class=r>
      {% if dl %}<a class="dl-link" href="/audio/dl?ids={{song.id}}">DL</a>{% endif %}
      {{current_song.track_string}}
    </td>
    <td name=title{% if current_song.date_added|is_recent %} class=new{% endif %}>
      {{current_song.title|escape}}</td>
    <td name=album><a href="{% url aenclave-album current_song.album|urlencode %}">{{current_song.album|escape}}</a></td>
    <td name=artist><a href="{% url aenclave-artist current_song.artist|urlencode %}">{{current_song.artist|escape}}</a></td>
    <td class=r>{{current_song.time_string}}</td>
    <td class=r>{{current_song.date_added_string}}</td>{% if user.is_authenticated %}
    <td class=edit onclick="songlist.edit_song(this);"></td>{% endif %}
   </tr>{% endif %}{% endif %}{% for song in song_list %}
   <tr class={% cycle a,b %}>
    <td><input type=checkbox name="{{song.id}}"/></td>
    <td name=track class=r>
      {% if dl %}<a class="dl-link" href="/audio/dl?ids={{song.id}}">DL</a>{% endif %}
      {{song.track_string}}
    </td>
    <td name=title{% if song.date_added|is_recent %} class=new{% endif %}>{% if no_queuing %}{{song.title|escape}}{% else %}<a class={% if song.last_queued|is_recent:1 %}recent{% else %}queue{% endif %} href="/audio/queue/?ids={{song.id}}">{{song.title|escape}}</a>{% endif %}</td>
    <td name=album>{% if song.album %}<a href="{% url aenclave-album song.album|urlencode %}">{{song.album|escape}}</a>{% endif %}</td>
    <td name=artist>{% if song.artist %}<a href="{% url aenclave-artist song.artist|urlencode %}">{{song.artist|escape}}{% endif %}</a></td>
    <td class=r>{{song.time_string}}</td>
    <td class=r>{{song.date_added_string}}</td>{% if user.is_authenticated %}
    <td class=edit onclick="songlist.edit_song(this);"></td>{% endif %}
   </tr>{% endfor %}
  </tbody>
 </table>
{% endif %}{% block postsonglist %}{% endblock %}{% endblock %}

{% block postcopyright %}{% if song_list or force_actions_bar %}
 <div id=actionsgap></div>
 <div id=actions>{% block actions %}{% if not no_queuing and song_list %}
  <a href="javascript:songlist.queue();" class=queue>Queue selected songs</a>{% endif %}{% if user.is_authenticated and song_list %}
  {% if dl %}
    <a href="javascript:songlist.dl();" class=dl>DL selected songs</a>
  {% endif %}
  <a href="javascript:songlist.askcreate();" class=create>Save as playlist&hellip;</a>
  <a href="javascript:songlist.askadd();" class=add>Add to playlist&hellip;</a>
  <a href="javascript:songlist.askdelete();" class=delete>Request for deletion</a>{% endif %}{% endblock %}

</div>
 <div id=subactions></div>{% if not no_queuing %}
 <form name=queueform action="{% url aenclave-queue-songs %}" method=POST>
  <input type=hidden name=ids>
 </form>{% endif %}{% if user.is_authenticated %}
 <form name=dlform action="/audio/dl/" method=POST>
  <input type=hidden name=ids>
 </form>
 <form name=createform action="/audio/playlists/create/" method=POST>
  <input type=hidden name=name>
  <input type=hidden name=ids>
 </form>
 <form name=addform action="/audio/playlists/add/" method=POST>
  <input type=hidden name=pid>
  <input type=hidden name=ids>
 </form>{% endif %}
 <form name=deleteform action="{% url aenclave-delete-songs %}" method=POST>
  <input type=hidden name=ids>
 </form>{% endif %}{% endblock %}
